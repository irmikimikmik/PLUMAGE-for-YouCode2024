import React from "react";
import { render } from "@testing-library/react";
import "@testing-library/jest-dom/extend-expect";
import { SiteContextProvider, SiteContextConsumer } from "./SiteContext";

describe("SiteContext tests", () => {
  test("SiteConsumer reads from props to set context", () => {
    const tree = (
      <SiteContextProvider market="outdoor" country="ca" language="en">
        <SiteContextConsumer>
          {({ market, country, language }) => (
            <p>
              Context is: {market}-{country}-{language}
            </p>
          )}
        </SiteContextConsumer>
      </SiteContextProvider>
    );
    const { getByText } = render(tree);
    expect(getByText(/^Context is:/)).toHaveTextContent("Context is: outdoor-ca-en");
  });

  test("SiteConsumer reads SOME props to set context", () => {
    const tree = (
      <SiteContextProvider country="ca">
        <SiteContextConsumer>
          {({ market, country, language }) => (
            <p>
              Context is: {market}-{country}-{language}
            </p>
          )}
        </SiteContextConsumer>
      </SiteContextProvider>
    );
    const { getByText } = render(tree);
    expect(getByText(/^Context is:/)).toHaveTextContent("Context is: -ca-");
  });
});
