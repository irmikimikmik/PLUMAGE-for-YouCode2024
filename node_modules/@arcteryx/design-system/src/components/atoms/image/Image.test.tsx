import React from "react";
import { render, screen } from "@testing-library/react";
import { Image } from "./Image";
import { type ImageProps } from "./Image.types";
import "@testing-library/jest-dom";

const imageProps: ImageProps = {
  alt: "Test Image",
  className: "test-class",
  height: 200,
  quality: 100,
  src: "https://cdn.sanity.io/images/inkbj32c/development/6101b55f8cb24904ef7cd6ae380389cb39954294-1080x1350.png",
  sizes: "100vw",
  shouldLazyLoad: false,
  width: 300,
};

describe("SimpleImage", () => {
  it("renders the image with the correct props", () => {
    render(<Image {...imageProps} />);
    const imageElement = screen.getByRole("img");
    expect(imageElement).toHaveAttribute("alt", imageProps.alt);
    expect(imageElement).toHaveAttribute("class", imageProps.className);

    if (imageProps.width !== undefined) {
      expect(imageElement).toHaveAttribute(
        "width",
        imageProps.width.toString(),
      );
    }

    if (imageProps.height !== undefined) {
      expect(imageElement).toHaveAttribute(
        "height",
        imageProps.height.toString(),
      );
    }

    expect(imageElement).toHaveAttribute("sizes", imageProps.sizes);

    expect(imageElement).toHaveAttribute("loading", "eager");
  });
});
